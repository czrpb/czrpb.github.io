---
marp: true
size: 16:9
theme: uncover
class: invert
paginate: true
math: katex
style: |
  @import 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/fontawesome.min.css';
  @import 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/solid.min.css';

  a {
    font-size: 17pt;
  }

  table {
    margin: 0 25px 25px 15px;
  }

  tbody {
    width: 100%;
  }

  .my-small-size {
    font-size: 8pt;
    margin: 0px;
    padding: 0px;
  }
  
  .my-medium-size {
    font-size: 12pt;
    margin: 0px;
    padding: 0px;
  }

  ul li {
    font-size: 20pt;
  }
  
  ul li ul li {
    font-size: 17pt;
  }

  blockquote {
    font-size: 22pt;
  }

  footer {
    left: auto;
    right: auto;
    top: auto;
    bottom: auto;

    right: 20px;
    top: 20px;
  }

  .code-container {
    position: relative;
    margin: 0.1em 0;
  }
  
  .code-container pre {
    margin: 0;
    padding: 0.1em;
    background-color: #f5f5f5;
    border: 1px solid #ddd;
    border-radius: 4px;
    overflow-x: auto;
  }

  code {
    font-size: 0.5em;
  }

  .run-icon {
    position: absolute;
    top: 0.5em;
    right: 0.5em;
    color: white;
    font-size: 12pt;
    text-decoration: none;
    z-index: 10;
    transition: color 0.2s ease;
  }

  .run-icon:hover {
    color: lightgreen;
  }

  #timer-widget {
    position: fixed;
    top: 12px;
    right: 12px;
    width: 180px;
    height: 80px;
    font-family: monospace;
    background: #1a1a2e;
    border-radius: 8px;
    z-index: 9999;
    user-select: none;
  }

  #timer-display {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    color: #0f0;
    transition: opacity .2s;
  }

  #timer-controls {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    opacity: 0;
    transition: opacity .2s;
    background: rgba(26, 26, 46, .85);
    border-radius: 8px;
  }

  #timer-widget:hover #timer-controls { opacity: 1; }
  #timer-widget:hover #timer-display  { opacity: .15; }

  #timer-min, #timer-sec {
    width: 36px;
    height: 28px;
    text-align: center;
    background: #0d0d1a;
    color: #0f0;
    border: 1px solid #0f0;
    border-radius: 4px;
    font: 16px monospace;
  }

  #timer-controls span {
    color: #0f0;
    font-size: 16px;
  }

  .timer-btn {
    padding: 4px 10px;
    font: bold 13px monospace;
    background: #0f0;
    color: #1a1a2e;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    min-width: 32px;
  }

  .timer-btn:hover {
    filter: brightness(1.2);
  }

  #timer-pause {
    display: none;
    background: #fa0;
  }
  
---

# Machine Learning 101

## kNN Speed Run

##### Quentin Crain

---

# Agenda

- What is ML?
- What is kNN?
- Let's Do It!

---

## Topics

- Machine Learning (ML): https://en.wikipedia.org/wiki/Machine_learning
    - https://developers.google.com/machine-learning/crash-course
    - https://www.coursera.org/articles/what-is-machine-learning
    - https://www.geeksforgeeks.org/machine-learning/ml-machine-learning/
&nbsp;

- kNN: https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm
    - https://www.geeksforgeeks.org/machine-learning/k-nearest-neighbours/
    - https://towardsdatascience.com/k-nearest-neighbor-classifier-explained-a-visual-guide-with-code-examples-for-beginners-a3d85cad00e1/
&nbsp;

- `plotly`: https://plotly.com/

- Scatter plot: https://en.wikipedia.org/wiki/Scatter_plot

---

# What is Machine Learning?

"Learn" from data to
*infer*/*generalize*/*predict*
labels for new data.

* ***Supervised***: **Label** new data given a labeled **dataset** from a set of **features**.
    - Ex: Regression (linear), Classification (kNN, ...), Decision Trees, SVM
* ***Unsupervised***: **Label** new data based on similarity/difference to a unlabeled **dataset** from a set of **features**.
    - Ex: Clustering (k-means, PCA)
* ***Reinforcement***: Create a **policy** to achieve a **goal** through **rewards**. 
    - Ex: NNs (CNN, RNN,), aka "AI"

https://ischool.syracuse.edu/what-is-machine-learning/

---

# What is kNN?

**It is a classification algorithm.**

<br/>

> A machine learning (ML) algorithm whereby
> data is "classified", ie: *labeled*, using
> existing labeled data.

---

# What is Classification?

Dataset

<img src="donuts.png" width="480" /><img src="tires.png" width="480" />

---

## Classify This!

Ready?

<div style="display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: auto auto; width: 100%; gap: 10px;">

<div data-marpit-fragment="1" style="grid-column: 1; grid-row: 1;">
<img src="tire-donut.png" width="480" />
</div>

<div data-marpit-fragment="2" style="grid-column: 1; grid-row: 2;">
tire
</div>

<div data-marpit-fragment="3" style="grid-column: 2; grid-row: 1;">
<img src="donut-tire.png" width="480" />
</div>

<div data-marpit-fragment="4" style="grid-column: 2; grid-row: 2;">
donut
</div>

</div>

---

## Classification Level: Extreme!

Ready?

<div data-marpit-fragment>
<img src="xmas-tree.png" width="480" />
</div>

---

# Let's Do It!

We are going to classify penguins!

---

# Define Your Question

<br/>

### Lost Penguin!!!

I found this penguin, who are their pals?

---

# Penguin Dataset

The penguin dataset is the "Hello World" for kNN learning.

[penguins_raw.csv](penguins_raw.csv)

(Good repo for ML datasets: https://archive.ics.uci.edu/ )

<div id="timer-widget">
  <div id="timer-display">00:00</div>
  <div id="timer-controls">
    <input id="timer-min" type="number" min="0" max="99" value="5">
    <span>:</span>
    <input id="timer-sec" type="number" min="0" max="59" value="0">
    <button id="timer-go" class="timer-btn">GO</button>
    <button id="timer-pause" class="timer-btn">&#9678;</button>
  </div>
</div>

<script>
(function(){
  const d  = document.getElementById('timer-display'),
        go = document.getElementById('timer-go'),
        pa = document.getElementById('timer-pause'),
        mIn= document.getElementById('timer-min'),
        sIn= document.getElementById('timer-sec');
  let iv=null, left=0, running=false, paused=false;

  function fmt(s){
    return String(Math.floor(s/60)).padStart(2,'0')+':'+String(s%60).padStart(2,'0');
  }

  function stop(){
    clearInterval(iv); iv=null;
    running=false; paused=false;
    go.textContent='GO'; pa.style.display='none';
  }

  function tick(){
    if(left<=0){ stop(); d.style.color='#f44'; d.textContent='00:00'; return; }
    left--; d.textContent=fmt(left);
    if(left<=10) d.style.color='#f44';
  }

  go.onclick=function(){
    if(running){ stop(); return; }
    left=(parseInt(mIn.value)||0)*60+(parseInt(sIn.value)||0);
    if(left<=0) return;
    d.style.color='#0f0'; d.textContent=fmt(left);
    running=true; paused=false;
    go.textContent='\u25A0'; pa.style.display='inline-block';
    iv=setInterval(tick,1000);
  };

  pa.onclick=function(){
    if(paused){
      paused=false; pa.innerHTML='&#9678;'; pa.style.background='#fa0';
      iv=setInterval(tick,1000);
    } else {
      paused=true; pa.textContent='\u25B6'; pa.style.background='#0af';
      clearInterval(iv); iv=null;
    }
  };
})();
</script>

---

# Extract Features & Clean

You will need two "features", characteristics of penguins you intent to classify on.

Extract your 2 features and the `Species` and `Sex` features, cleaning as you do so.

Lets say you end with a file: `penguins_clean.csv`

---

# Divide Your Data

You need 3 datasets in ML projects:

<br/>

- ***Training***: This is your known good data to build your model on/with.
    - 90% of your records; ~270 records
- ***Validation***: This the small subset of known good data to verify your model's goodness.
    - 5% of your records; ~15 records
- ***Test***: This the data for your model to label/predict.
    - 5% of your records; ~15 records

---

# Visualize Your Training Data

<br/>

Explore your training data:

- https://plotly.com/python/px-arguments/#passing-dictionaries-or-arraylikes-as-the-dataframe-argument
- https://plotly.com/python/line-and-scatter/#setting-size-and-color-with-column-names

Start here: [viz.py](viz.py) [viz.csv](viz.csv)

---

# kNN: k Nearest Neighbors

> You are who you are nearest.

---

# kNN: The Intuition

<br/>

When a new entity is to be classified

via the **features** under consideration

"distance" implies similarity.

---

# kNN: The Math

<br/>

<div style="display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: auto auto auto; width: 100%; gap: 10px;">

<div style="grid-column: 1; grid-row: 1;">
<h4>Euclidean distance</h4>
</div>

<div style="grid-column: 2; grid-row: 1;">
<h4>Manhattan distance</h4>
</div>

<div style="grid-column: 1; grid-row: 2;">

$\overline{dist_x} = \sqrt{\sum_n{(\vec{x}-\vec{y_n})^2}}$

</div>

<div style="grid-column: 2; grid-row: 2;">

$\overline{dist_x} = \sum_n{|\vec{x}-\vec{y_n}|}$

</div>

</div>

---

# kNN: Vizualized

<br/>

<img src="Distance.png" width="640" />

---

# More Presentations

- [DS 101](ds101.html)
- [kNN 101](knn101.html)

---

# E  N  D
